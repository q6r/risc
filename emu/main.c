/* - qnix
 */
#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>
#include <stdint.h>
#include <string.h>
#include <config.h>
#include "emu.h"

const uint8_t code[] = {
// SET 4 TEST 32bit
	0xc1, 0x00, 0x11, 0x22, 0x33, 0x44,	/* addid r1, 0x11223344 */
	0xc1, 0x01, 0x11, 0x22, 0x33, 0x44,	/* addid r2, 0x11223344 */
	0xc1, 0x02, 0x11, 0x22, 0x33, 0x44,	/* addid r3, 0x11223344 */
	0xc1, 0x03, 0x11, 0x22, 0x33, 0x44,	/* addid r4, 0x11223344 */
	0xc2, 0x00, 0x11, 0x22, 0x33, 0x44,	/* subid r1, 0x11223344 */
	0xc2, 0x01, 0x11, 0x22, 0x33, 0x44,	/* subid r2, 0x11223344 */
	0xc2, 0x02, 0x11, 0x22, 0x33, 0x44,	/* subid r3, 0x11223344 */
	0xc2, 0x03, 0x11, 0x22, 0x33, 0x44,	/* subid r4, 0x11223344 */
	0xc3, 0x00, 0x11, 0x22, 0x33, 0x44,	/* mulid r1, 0x11223344 */
	0xc3, 0x01, 0x11, 0x22, 0x33, 0x44,	/* mulid r2, 0x11223344 */
	0xc3, 0x02, 0x11, 0x22, 0x33, 0x44,	/* mulid r3, 0x11223344 */
	0xc3, 0x03, 0x11, 0x22, 0x33, 0x44,	/* mulid r4, 0x11223344 */
	0xc4, 0x00, 0x11, 0x22, 0x33, 0x44,	/* divid r1, 0x11223344 */
	0xc4, 0x01, 0x11, 0x22, 0x33, 0x44,	/* divid r2, 0x11223344 */
	0xc4, 0x02, 0x11, 0x22, 0x33, 0x44,	/* divid r3, 0x11223344 */
	0xc4, 0x03, 0x11, 0x22, 0x33, 0x44,	/* divid r4, 0x11223344 */
	0xc5, 0x00, 0x11, 0x22, 0x33, 0x44,	/* xorid r1, 0x11223344 */
	0xc5, 0x01, 0x11, 0x22, 0x33, 0x44,	/* xorid r2, 0x11223344 */
	0xc5, 0x02, 0x11, 0x22, 0x33, 0x44,	/* xorid r3, 0x11223344 */
	0xc5, 0x03, 0x11, 0x22, 0x33, 0x44,	/* xorid r4, 0x11223344 */
	0xc6, 0x00, 0x11, 0x22, 0x33, 0x44,	/* movid r1, 0x11223344 */
	0xc6, 0x01, 0x11, 0x22, 0x33, 0x44,	/* movid r2, 0x11223344 */
	0xc6, 0x02, 0x11, 0x22, 0x33, 0x44,	/* movid r3, 0x11223344 */
	0xc6, 0x03, 0x11, 0x22, 0x33, 0x44,	/* movid r4, 0x11223344 */
	0xdb, 0x11, 0x22, 0x33, 0x44,	/* pushid 0x11223344 */
	0xab, 0x00,		/* pushd r1 */
	0xab, 0x01,		/* pushd r2 */
	0xab, 0x02,		/* pushd r3 */
	0xab, 0x03,		/* pushd r4 */
	0xac, 0x00,		/* popd r1 */
	0xac, 0x01,		/* popd r1 */
	0xac, 0x02,		/* popd r1 */
	0xac, 0x03,		/* popd r1 */
//      0xaf                                        /* exit */
// SET 3 TEST 16bit
	0xd1, 0x00, 0x11, 0x22,	/* addiw r1, 0x1122 */
	0xd1, 0x01, 0x11, 0x22,	/* addiw r2, 0x1122 */
	0xd1, 0x02, 0x11, 0x22,	/* addiw r3, 0x1122 */
	0xd1, 0x03, 0x11, 0x22,	/* addiw r4, 0x1122 */
	0xd2, 0x00, 0x11, 0x22,	/* subiw r1, 0x1122 */
	0xd2, 0x01, 0x11, 0x22,	/* subiw r2, 0x1122 */
	0xd2, 0x02, 0x11, 0x22,	/* subiw r3, 0x1122 */
	0xd2, 0x03, 0x11, 0x22,	/* subiw r4, 0x1122 */
	0xd3, 0x00, 0x11, 0x22,	/* muliw r1, 0x1122 */
	0xd3, 0x01, 0x11, 0x22,	/* muliw r2, 0x1122 */
	0xd3, 0x02, 0x11, 0x22,	/* muliw r3, 0x1122 */
	0xd3, 0x03, 0x11, 0x22,	/* muliw r4, 0x1122 */
	0xd4, 0x00, 0x11, 0x22,	/* diviw r1, 0x1122 */
	0xd4, 0x01, 0x11, 0x22,	/* diviw r2, 0x1122 */
	0xd4, 0x02, 0x11, 0x22,	/* diviw r3, 0x1122 */
	0xd4, 0x03, 0x11, 0x22,	/* diviw r4, 0x1122 */
	0xd5, 0x00, 0x11, 0x22,	/* xoriw r1, 0x1122 */
	0xd5, 0x01, 0x11, 0x22,	/* xoriw r2, 0x1122 */
	0xd5, 0x02, 0x11, 0x22,	/* xoriw r3, 0x1122 */
	0xd5, 0x03, 0x11, 0x22,	/* xoriw r4, 0x1122 */
	0xd6, 0x00, 0x11, 0x22,	/* moviw r1, 0x1122 */
	0xd6, 0x01, 0x11, 0x22,	/* moviw r2, 0x1122 */
	0xd6, 0x02, 0x11, 0x22,	/* moviw r3, 0x1122 */
	0xd6, 0x03, 0x11, 0x22,	/* moviw r4, 0x1122 */
	0xda, 0x11, 0x22,	/* pushiw 0x1122 */
	0xaa, 0x00,		/* pushw r1 */
	0xaa, 0x01,		/* pushw r2 */
	0xaa, 0x02,		/* pushw r3 */
	0xaa, 0x03,		/* pushw r4 */
	0xad, 0x00,		/* popw r1 */
	0xad, 0x01,		/* popw r2 */
	0xad, 0x02,		/* popw r3 */
	0xad, 0x03,		/* popw r4 */
//      0xaf                                      /* exit */
// SET 2 TEST 8bit
	0xb1, 0x00, 0xff,	/* addib r1, 0xff */
	0xb1, 0x01, 0xff,	/* addib r2, 0xff */
	0xb1, 0x02, 0xff,	/* addib r3, 0xff */
	0xb1, 0x03, 0xff,	/* addib r4, 0xff */
	0xb2, 0x00, 0xff,	/* subib r1, 0xff */
	0xb2, 0x01, 0xff,	/* subib r2, 0xff */
	0xb2, 0x02, 0xff,	/* subib r3, 0xff */
	0xb2, 0x03, 0xff,	/* subib r4, 0xff */
	0xb3, 0x00, 0xff,	/* mulib r1, 0xff */
	0xb3, 0x01, 0xff,	/* mulib r2, 0xff */
	0xb3, 0x02, 0xff,	/* mulib r3, 0xff */
	0xb3, 0x03, 0xff,	/* mulib r4, 0xff */
	0xb4, 0x00, 0xff,	/* divib r1, 0xff */
	0xb4, 0x01, 0xff,	/* divib r2, 0xff */
	0xb4, 0x02, 0xff,	/* divib r3, 0xff */
	0xb4, 0x03, 0xff,	/* divib r4, 0xff */
	0xb5, 0x00, 0xff,	/* xorib r1, 0xff */
	0xb5, 0x01, 0xff,	/* xorib r2, 0xff */
	0xb5, 0x02, 0xff,	/* xorib r3, 0xff */
	0xb5, 0x03, 0xff,	/* xorib r4, 0xff */
	0xb6, 0x00, 0xff,	/* movib r1, 0xff */
	0xb6, 0x01, 0xff,	/* movib r2, 0xff */
	0xb6, 0x02, 0xff,	/* movib r3, 0xff */
	0xb6, 0x03, 0xff,	/* movib r4, 0xff */
	0xd9, 0xff,		/* pushib 0xff */
	0xa9, 0x00,		/* pushb r1 */
	0xa9, 0x01,		/* pushb r2 */
	0xa9, 0x02,		/* pushb r3 */
	0xa9, 0x03,		/* pushb r4 */
	0xac, 0x00,		/* popb r1 */
	0xac, 0x01,		/* popb r2 */
	0xac, 0x02,		/* popb r3 */
	0xac, 0x03,		/* popb r4 */
// SET 1 TEST registers 
	0xa8, 0x00,		/* dec r1 */
	0xa8, 0x01,		/* dec r2 */
	0xa8, 0x02,		/* dec r3 */
	0xa8, 0x03,		/* dec r4 */
	0xa7, 0x00,		/* inc r1 */
	0xa7, 0x01,		/* inc r2 */
	0xa7, 0x02,		/* inc r3 */
	0xa7, 0x03,		/* inc r4 */
	0xa1, 0x00, 0x01,	/* add r1, r2 */
	0xa1, 0x02, 0x03,	/* add r2, r3 */
	0xa2, 0x00, 0x01,	/* sub r1, r2 */
	0xa2, 0x02, 0x03,	/* sub r3, r4 */
	0xa3, 0x00, 0x01,	/* mul r1, r2 */
	0xa3, 0x02, 0x03,	/* mul r3, r4 */
	0xa4, 0x00, 0x01,	/* div r1, r2 */
	0xa4, 0x02, 0x03,	/* div r3, r4 */
	0xa5, 0x00, 0x01,	/* xor r1, r2 */
	0xa5, 0x02, 0x03,	/* xor r3, r4 */
	0xa6, 0x00, 0x01,	/* mov r1, r2 */
	0xa6, 0x02, 0x03,	/* mov r3, r4 */
	0xaf			/* exit */
};

int main()
{
	vm_t vm;
	init_vm(&vm, 1024, 1024);
	memcpy(vm.code, code, sizeof code);
	if (process_code(&vm, true, true) == false) {
		printf("Failed processing code\n");
	}
	term_vm(&vm);
	return 0;
}
